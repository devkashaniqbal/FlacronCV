services:
  # Backend API
  - type: web
    name: flacroncv-api
    runtime: node
    region: oregon
    plan: starter
    buildCommand: corepack enable && corepack prepare pnpm@8.15.0 --activate && pnpm install && pnpm build:api
    startCommand: node apps/api/dist/main.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 4000
      - key: FRONTEND_URL
        value: https://flacroncv-web.onrender.com
      - key: FIREBASE_PROJECT_ID
        sync: false
      - key: FIREBASE_PRIVATE_KEY
        sync: false
      - key: FIREBASE_CLIENT_EMAIL
        sync: false
      - key: FIREBASE_STORAGE_BUCKET
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: WATSONX_API_KEY
        sync: false
      - key: WATSONX_URL
        sync: false
      - key: WATSONX_PROJECT_ID
        sync: false
      - key: STRIPE_SECRET_KEY
        sync: false
      - key: STRIPE_WEBHOOK_SECRET
        sync: false
      - key: STRIPE_PRO_MONTHLY_PRICE_ID
        sync: false
      - key: STRIPE_PRO_YEARLY_PRICE_ID
        sync: false
      - key: STRIPE_ENTERPRISE_MONTHLY_PRICE_ID
        sync: false
      - key: STRIPE_ENTERPRISE_YEARLY_PRICE_ID
        sync: false

  # Frontend Web App
  - type: web
    name: flacroncv-web
    runtime: node
    region: oregon
    plan: starter
    buildCommand: corepack enable && corepack prepare pnpm@8.15.0 --activate && pnpm install && pnpm build:web
    startCommand: pnpm start:web
    envVars:
      - key: NODE_ENV
        value: production
      - key: NEXT_PUBLIC_API_URL
        value: https://flacroncv-api.onrender.com/api/v1
      - key: NEXT_PUBLIC_FIREBASE_API_KEY
        sync: false
      - key: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
        sync: false
      - key: NEXT_PUBLIC_FIREBASE_PROJECT_ID
        sync: false
      - key: NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET
        sync: false
      - key: NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID
        sync: false
      - key: NEXT_PUBLIC_FIREBASE_APP_ID
        sync: false
